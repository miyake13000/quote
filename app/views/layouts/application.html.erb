<!DOCTYPE html>
<html>
  <head>
    <title><%= @year_param? "#{@year_param}年度 ": "" %>迷言集</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "actiontext", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-50">

    <!-- Whole of Screen -->
    <div class="min-h-screen flex flex-col">

      <!-- Header -->
      <header class="bg-gray-50 border-b border-gray-300 shadow-md fixed top-0 left-0 right-0 z-10">
        <div class="flex items-center justify-between px-6 py-4">

          <!-- Header Title -->
          <div class="text-2xl">
            <a href=<%= root_path %>>
              <%= @year_param.nil? ? "" : "#{@year_param}年度 " %>迷言集
            </a>
          </div>

          <!-- Login / Logout -->
          <div>
            <% if admin_signed_in? %>
              <%= link_to 'ログアウト', destroy_admin_session_path,
                  data: { turbo_method: :delete },
                  class: "text-blue-600 hover:text-blue-700 font-medium" %>
            <% else %>
              <%= link_to 'ログイン', new_admin_session_path,
                  class: "text-blue-600 hover:text-blue-700 font-medium" %>
            <% end %>
          </div>

        </div>
      </header>

      <!-- Main Screen (Sidebar + Content) -->
      <div class="flex flex-1 pt-16">

        <!-- Sidebar -->
        <aside class="w-48 bg-gray-200 border-r border-gray-400 fixed left-0 top-16 bottom-0 overflow-y-auto">
          <ul class="p-4 list-disc list-inside">
            <% @years.each do |year| %>
              <li class="my-3">
                <a class="text-xl underline hover:bg-white" href=<%= "#{posts_url}?year=#{year}"%>>
                    <%= "#{year}年度" %>
                </a>
              </li>
            <% end %>
          </ul>
        </aside>

        <!-- Content -->
        <main class="flex-1 ml-48 p-6">

          <!-- flash for devise -->
          <% if notice.present? %>
            <p class="notice bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded mb-4">
              <%= notice %>
            </p>
          <% end %>
          <% if alert.present? %>
            <p class="alert bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded mb-4">
              <%= alert %>
            </p>
          <% end %>

          <!-- Main Content -->
          <%= yield %>

        </main>
      </div>
    </div>
  </body>
</html>
